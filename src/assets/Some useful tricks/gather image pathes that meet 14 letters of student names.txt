Sub MatchPhotos()
    Dim ws As Worksheet
    Dim studentName As String
    Dim folderPath As String
    Dim photoPath As String
    Dim i As Long
    Dim fileName As String
    Dim fso As Object
    Dim file As Object
    Dim firstEightLetters As String
    Dim pathNum As Integer

    

    ' Set the worksheet
    Set ws = ThisWorkbook.Sheets(2) ' Adjust the sheet index or name as necessary

    ' Set the folder path
    folderPath = ThisWorkbook.Path & "\"

    ' Create FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")

    ' Loop through the student names in Column C
    For i = 1 To ws.Cells(ws.Rows.Count, "C").End(xlUp).Row
        studentName = ws.Cells(i, 3).Value

        ' Get the first 8 letters of the student name
        If Len(studentName) >= 14 Then
            firstEightLetters = Left(studentName, 14)
        Else
            firstEightLetters = studentName
        End If

        ' Loop through the files in the folder
        For Each file In fso.GetFolder(folderPath).Files
            fileName = file.Name

            ' Check if the file name contains the first 8 letters of the student name
            If InStr(1, fileName, firstEightLetters, vbTextCompare) > 0 Then
                photoPath = folderPath & fileName
                ws.Cells(i, 4).Value = photoPath
                pathNum = pathNum + 1
                
                Exit For
            End If
        Next file
    Next i

    ' Clean up
    Set fso = Nothing
    MsgBox "There are " & pathNum & " element(s)."
End Sub