Sub MatchPhotos()
    Dim ws As Worksheet
    Dim studentId As String
    Dim folderPath As String
    Dim photoPath As String
    Dim i As Long
    Dim fileName As String
    Dim fso As Object
    Dim file As Object
    Dim pathNum As Integer

    ' Set the worksheet
    Set ws = ThisWorkbook.Sheets(1) ' Adjust the sheet index or name as necessary

    ' Set the folder path
    folderPath = ThisWorkbook.Path & "\"

    ' Create FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")

    ' Loop through the student Ids in Column G
    For i = 1 To ws.Cells(ws.Rows.Count, "G").End(xlUp).Row
    
        studentId = ws.Cells(i, 7).Value

        ' Loop through the files in the folder
        For Each file In fso.GetFolder(folderPath).Files
            fileName = file.Name
            ' Check if the file name contains the first 8 letters of the student name
            If InStr(1, fileName, studentId, vbTextCompare) > 0 Then
                photoPath = folderPath & fileName

                If (IsEmpty(ws.Cells(i, 3).Value)) Then
                ws.Cells(i, 3).Value = photoPath
                pathNum = pathNum + 1
                 End If
                Exit For
            End If
        Next file
    Next i

    ' Clean up
    Set fso = Nothing
    MsgBox "There are " & pathNum & " element(s)."
End Sub

